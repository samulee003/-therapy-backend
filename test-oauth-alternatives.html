<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OAuth æ›¿ä»£ç«¯é»æ¸¬è©¦</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 700px;
            margin: 50px auto;
            padding: 20px;
        }
        .test-section {
            background: #f5f5f5;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            border-left: 4px solid #4285f4;
        }
        .test-button {
            background: #4285f4;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 0;
            display: block;
            width: 100%;
        }
        .test-button:hover {
            background: #3367d6;
        }
        .url-preview {
            background: #f1f3f4;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            word-break: break-all;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>ğŸ”„ OAuth æ›¿ä»£ç«¯é»æ¸¬è©¦</h1>
    
    <div class="test-section">
        <h3>æ–¹æ³• 1ï¼šæ¨™æº– OAuth 2.0 ç«¯é»</h3>
        <div class="url-preview" id="url1"></div>
        <button class="test-button" onclick="testMethod1()">æ¸¬è©¦æ–¹æ³• 1</button>
    </div>

    <div class="test-section">
        <h3>æ–¹æ³• 2ï¼šèˆŠç‰ˆ OAuth ç«¯é»</h3>
        <div class="url-preview" id="url2"></div>
        <button class="test-button" onclick="testMethod2()">æ¸¬è©¦æ–¹æ³• 2</button>
    </div>

    <div class="test-section">
        <h3>æ–¹æ³• 3ï¼šOAuth 1.0 å…¼å®¹ç«¯é»</h3>
        <div class="url-preview" id="url3"></div>
        <button class="test-button" onclick="testMethod3()">æ¸¬è©¦æ–¹æ³• 3</button>
    </div>

    <div class="test-section">
        <h3>æ–¹æ³• 4ï¼šGoogle Identity Services (GSI)</h3>
        <div id="gsi-container">
            <p>è¼‰å…¥ Google Identity Services...</p>
        </div>
        <button class="test-button" onclick="testGSI()">æ¸¬è©¦ GSI æ–¹æ³•</button>
    </div>

    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <script>
        const CLIENT_ID = '18566096794-ec7qc6cekboq6am8laiv5odkbqd4i18f.apps.googleusercontent.com';
        const REDIRECT_URI = 'http://localhost:8080';
        
        // æ–¹æ³• 1ï¼šæ¨™æº– OAuth 2.0
        function testMethod1() {
            const url = `https://accounts.google.com/oauth2/v2/auth?client_id=${CLIENT_ID}&redirect_uri=${encodeURIComponent(REDIRECT_URI)}&response_type=code&scope=openid%20email%20profile`;
            document.getElementById('url1').textContent = url;
            setTimeout(() => window.location.href = url, 2000);
        }
        
        // æ–¹æ³• 2ï¼šèˆŠç‰ˆç«¯é»
        function testMethod2() {
            const url = `https://accounts.google.com/o/oauth2/auth?client_id=${CLIENT_ID}&redirect_uri=${encodeURIComponent(REDIRECT_URI)}&response_type=code&scope=openid%20email%20profile`;
            document.getElementById('url2').textContent = url;
            setTimeout(() => window.location.href = url, 2000);
        }
        
        // æ–¹æ³• 3ï¼šOAuth 1.0 å…¼å®¹
        function testMethod3() {
            const url = `https://accounts.google.com/oauth2/v2/auth?client_id=${CLIENT_ID}&redirect_uri=${encodeURIComponent(REDIRECT_URI)}&response_type=code`;
            document.getElementById('url3').textContent = url;
            setTimeout(() => window.location.href = url, 2000);
        }
        
        // æ–¹æ³• 4ï¼šGoogle Identity Services
        function testGSI() {
            if (window.google) {
                try {
                    window.google.accounts.id.initialize({
                        client_id: CLIENT_ID,
                        callback: handleCredentialResponse
                    });
                    
                    window.google.accounts.id.prompt((notification) => {
                        if (notification.isNotDisplayed()) {
                            alert('GSI æç¤ºæœªé¡¯ç¤º: ' + notification.getNotDisplayedReason());
                        }
                    });
                } catch (error) {
                    alert('GSI éŒ¯èª¤: ' + error.message);
                }
            } else {
                alert('Google Identity Services æœªè¼‰å…¥');
            }
        }
        
        function handleCredentialResponse(response) {
            document.body.innerHTML = `
                <h1 style="color: green;">ğŸ‰ GSI æˆåŠŸï¼</h1>
                <p><strong>JWT Token:</strong> ${response.credential.substring(0, 50)}...</p>
                <p>Google OAuth é€šé GSI å·¥ä½œæ­£å¸¸ï¼</p>
            `;
        }
        
        // æª¢æŸ¥å›èª¿
        window.onload = function() {
            const urlParams = new URLSearchParams(window.location.search);
            const code = urlParams.get('code');
            const error = urlParams.get('error');
            
            if (code) {
                document.body.innerHTML = `
                    <h1 style="color: green;">ğŸ‰ æˆåŠŸï¼</h1>
                    <p><strong>æˆæ¬Šç¢¼:</strong> ${code}</p>
                    <p>OAuth é…ç½®æ­£ç¢ºï¼</p>
                `;
            } else if (error) {
                document.body.innerHTML = `
                    <h1 style="color: red;">âŒ éŒ¯èª¤</h1>
                    <p><strong>éŒ¯èª¤:</strong> ${error}</p>
                `;
            }
            
            // é è¦½ URLs
            document.getElementById('url1').textContent = `https://accounts.google.com/oauth2/v2/auth?client_id=${CLIENT_ID}&redirect_uri=${encodeURIComponent(REDIRECT_URI)}&response_type=code&scope=openid%20email%20profile`;
            document.getElementById('url2').textContent = `https://accounts.google.com/o/oauth2/auth?client_id=${CLIENT_ID}&redirect_uri=${encodeURIComponent(REDIRECT_URI)}&response_type=code&scope=openid%20email%20profile`;
            document.getElementById('url3').textContent = `https://accounts.google.com/oauth2/v2/auth?client_id=${CLIENT_ID}&redirect_uri=${encodeURIComponent(REDIRECT_URI)}&response_type=code`;
        };
    </script>
</body>
</html> 